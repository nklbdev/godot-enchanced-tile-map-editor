# Расширенный редактор тайловых карт для Godot 3.5x

[![en](https://img.shields.io/badge/lang-en-red.svg)](README.md)
[![ru](https://img.shields.io/badge/lang-ru-green.svg)](README.ru.md)

Приветствую всех пользователей движка Godot! Я разрабатываю альтернативный редактор тайловых карт для этого движка версии 3.5x.
Это пока ранняя альфа-версия, но уже пригодна к использованию. Буду рад вашим пожеланиям и помощи в развитии редактора!

## Возможности:
- Прямоугольное выделение, непрерывное выделение ("волшебная палочка"), комбинации выделенных областей.
- Встроенная мощная палитра тайлов
- Рисование паттернами
- Поддержка отмены/повторения действий с картой
- Сохранение паттернов в нижнюю панель, метаданные тайлсета (пока не готово), или копирование их как обычный JSON-текст
- Повороты и отражения паттернов на все возможные углы вместе с тайлами в ячейках или без них (и удобный набор клавиатурных сокращений для этого)
- 3 автотайлера: Классический, Улучшенный и Тайлер местности (их алгоритмы уже реализованы, но еще не интегрированы в плагин)

![Main view of the plugin interface](https://user-images.githubusercontent.com/7024016/214442952-e9899aba-8ec7-47c7-b1bc-ef5e82edfd3b.png)

[![Godot Enchanced TileMap Editor eraly alpha presentation](https://img.youtube.com/vi/HuihzLfFYgU/0.jpg)](https://www.youtube.com/watch?v=HuihzLfFYgU)

Когда вы выбираете экземпляр тайловой карты (`TileMap`) в дереве сцены, появляется нижняя панель "Tile Map", на которой находятся палитры и инструменты.

## Инструменты

### Выделение

- __Прямоугольное выделение__ - всеми любимое прямоугольное выделение)).
- __Непрерывное выделение__ ("Волшебная Палочка") - пока не очень полезный инструмент. Но скоро будет добавлено умное выделение паттернов.

Вы можете комбинировать выделенные области, начиная выделение с зажатым `Shift` (объединение), `Ctrl+Shift` (пересечение) и `Alt+Shift` (вычитание).

И вы можете скопировать выделение в буфер обмена в виде сериализованного паттерна. В этом случае паттерн будет сразу доступен для рисования во всех инструментах. Вы можете рисовать им на тайловой карте или вставить его в панель коллекции паттернов или в любое другое место как JSON-текст.

### Рисование

- __Кисть паттерна__ - просто кисть. Но она переключается на Линию, когда нажат `Ctrl`, и на Прямоугольник, когда нажато `Ctrl+Shift`.
- __Линия паттерна__ - рисует линию. Ведет себя по-разному с паттерном из одной ячейки и со сложными паттернами на картах со полусмещением ячеек. С паттерном из одной ячейки инструмент образует непрерывную линию, как реализовано в Godot 4,
- __Прямоугольник паттерна__ - всем известный прямоугольник).
- __Заливка паттерном__ - позволяет делать заливку и смещать сетку паттернов движением курсора при зажатой левой кнопке мыши.
- __Выбор тайла ("Пипетка")__ (пока не реализовано)
- __"Стирательная резинка"__ - просто стирательная резинка
- __Случайные тайлы__ - модификатор, позволяющий рисовать не паттерном, а одиночной ячейкой, которая подставляет случайный субтайл из паттерна. И опция рассеяния как в Godot 4 (это пока не реализовано)
- __Поворот паттерна__ - меню, позволяющее поворачивать паттерны на все возможные углы для текущего полусмещения ячеек (`cell_half_offset`).
- __Отражение паттерна__ - то же самое, только для отражений паттернов.

[![Examples of pattern transformation](https://user-images.githubusercontent.com/7024016/217090210-f9170f2e-1625-4e13-9b8f-bebbd558bbbd.png)](https://user-images.githubusercontent.com/7024016/217090041-5444e3dc-3f4c-4e2d-8a44-24cceaf9a180.png)

## Субпалитра "By Texture"

Представляет раскладку тайлов на текстурах, как они размечены в тайлсете (`TileSet`). На одной текстуре может быть размечено много тайлов. Лучший выбор, чтобы рисовать прямоугольные карты.

[![Texture tiles layout](https://user-images.githubusercontent.com/7024016/217073166-04fc2a0f-c896-442a-b447-3986f08d5f5d.png)](https://user-images.githubusercontent.com/7024016/217072418-1fdb6831-ec6c-46d0-9bde-0da393dd6bc3.png)

## Субпалитра "Individual"

Представляет раскладку тайлов на тайловой карте с такими же настройками `mode` и `custom_cell_transform` и `cell_half_offset` как в текущей тайловой карте. Она удобна для выбора паттернов для непрямоугольных карт или карт с полусмещением ячеек (имитация "сот"). Так как настройка каждого тайла индивидуальна, палитра может показывать раскладку только одного тайла за раз.

[![Tile map tiles layout](https://user-images.githubusercontent.com/7024016/217073330-8d163be1-1293-4eb6-ad51-cf7137e7aa9b.png)](https://user-images.githubusercontent.com/7024016/217072531-8d6554ff-9ed8-4c65-b1b8-c7bde9a86b30.png)

## Субпалитра "Patterns"

Эта палитра - коллекция для вставки скопированных паттернов с карты или из других палитр. Она уже работоспособна, но визуально еще не готова. На ней будут отображаться миниатюры вставленных паттернов. Паттерны могут быть вставлены сюда нажатием `Ctrl+V`.
Паттерны могут быть вставлены не только сюда, но куда угодно как обычный JSON-текст. Вы можете обмениваться ими мгновенно через любой мессенджер!

[![Patterns collection buffer](https://user-images.githubusercontent.com/7024016/217073422-4d66b631-4746-4b0d-9e53-764ce1f2a227.png)](https://user-images.githubusercontent.com/7024016/217072621-2d50adce-b4f2-400b-b3af-9386b7400637.png)

## Автотайлы

(Алгоритмы уже реализованы, но еще не интегрированы в плагин. Их работу вы можете увидеть на видео выше)

## Настройка/персонализация

[![Plugin section in Project Settings](https://user-images.githubusercontent.com/7024016/217080889-944b65f5-33ac-4b5f-ad3f-56565712898b.png)](https://user-images.githubusercontent.com/7024016/217080797-db6bf9c0-51ea-4386-a181-0927f8a656fd.png)

В настройках проекта есть секция опций для этого плагина. Вы можете выбрать в ней ограничение на количество рисуемых ячеек, размеры подсвечиваемых сеток и их цвета.

## Установка

Просто скачайте или склонируйте через GIT этот репозиторий и скопируйте содержимое папки `addons` в одноименную папку в вашем проекте.

После этого включите плагин в настройках проетка в секции "Плагины"
